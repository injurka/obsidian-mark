# Кратко

Асимметричное шифрование — относительно новая криптографическая система, появившаяся в 1970-х годах. Его основная цель — устранить уязвимость симметричного шифрования, т. е. использования одного ключа.

Асимметричное шифрование, также называемое шифрованием с открытым ключом, представляет собой криптографическую систему, использующую два ключа. Открытый ключ может передаваться по незащищенному каналу и используется для шифрования сообщения. Для расшифровки сообщения используется закрытый ключ, известный только получателю.  
  
Пара ключей математически связана друг с другом, поэтому вы можете вычислить открытый ключ, зная закрытый, но не наоборот.

Вот как работает асимметричное шифрование:

1. Получатель выбирает алгоритм шифрования и генерирует пару открытого и закрытого ключей.
2. Получатель передает открытый ключ отправителю.
3. Отправитель шифрует сообщение с помощью открытого ключа и отправляет зашифрованное сообщение получателю.
4. Получатель получает зашифрованное сообщение и расшифровывает его, используя свой закрытый ключ.

![[./assets/asymmetrical.png]]

## Алгоритмы криптографии с асимметричным ключом

Примеры известных алгоритмов асимметричного шифрования включают:

- RSA (Rivest Shamir Adleman), старейший алгоритм асимметричного шифрования, был опубликован в 1977 году и назван в честь его создателей, американских ученых из Массачусетского технологического института (MIT) Рона Ривеста, Ади Шамира и Леонарда Адлемана. Это относительно медленный алгоритм, часто используемый в гибридных системах шифрования в сочетании с симметричными алгоритмами.
- DSA (алгоритм цифровой подписи) был создан в 1991 году Национальным институтом стандартов и технологий (NIST) в США. Он используется для аутентификации цифровой подписи. В этом алгоритме электронная подпись создается с помощью закрытого ключа, но может быть проверена с помощью открытого ключа. Это означает, что только владелец подписи может создать подпись, но любой может проверить ее подлинность.
- ECDSA (алгоритм цифровой подписи на эллиптических кривых) — это алгоритм с открытым ключом для создания цифровой подписи. Это вариант DSA, использующий криптографию на основе эллиптических кривых. ECDSA используется в сети Биткойн для подписи транзакций.
- Диффи-Хеллман был опубликован в 1976 году американскими криптографами Уитфилдом Диффи и Мартином Хеллманом. Это криптографический протокол, который позволяет двум или более сторонам получить общий закрытый ключ, используя незащищенный канал связи. Ключ используется для шифрования остальной части обмена с использованием алгоритмов симметричного шифрования. Схема распространения ключей по защищенным каналам, предложенная Диффи и Хеллманом, стала важным прорывом в криптографии, поскольку устранила основную проблему классической криптографии — распределение ключей.

## Сильные и слабые стороны криптографии с асимметричным ключом

Наиболее очевидным преимуществом этого типа шифрования является его безопасность, поскольку закрытый ключ не нужно никому передавать. Конечно, это значительно упрощает управление ключами в больших сетях.  
  
Однако у этого метода шифрования есть и недостатки. Одним из примеров является более высокая сложность, более низкая скорость и более высокий спрос на вычислительные ресурсы. Кроме того, несмотря на высокую безопасность асимметричного шифрования, оно по-прежнему уязвимо для атаки «человек посередине» (MITM), при которой злоумышленник перехватывает открытый ключ, отправленный получателем отправителю. Затем злоумышленник создает свою собственную пару ключей и маскируется под получателя, отправляя отправителю ложный открытый ключ, который отправитель считает открытым ключом, отправленным получателем. Злоумышленник перехватывает зашифрованные сообщения от отправителя к получателю, расшифровывает их с помощью своего закрытого ключа, повторно шифрует их с помощью открытого ключа получателя и отправляет сообщение получателю. В этом случае, никто из участников не осознает, что третья сторона перехватывает сообщение или подменяет его ложным. Это подчеркивает необходимость аутентификации с открытым ключом.

---

# Подробно

> **Эллиптическая кривая**
> это множество точек, удовлетворяющих уравнению
> $y^2 + a_1xy + a_3y = x^3 + a_2x^2 + a_4x + a_6$

Математический аппарат эллиптических кривых был использован в криптосистемах с открытым ключом.

---

## Определение эллиптических кривых над простыми конечными полями

Дано:
- $p>3$ — простое число
- ```a``` и ```b``` — элементы конечного поля порядка ```p```
- $4a^2 + 27b^2 ≠ 0$

**Эллиптическая кривая над конечным полем порядка ``p``**
- множество решений ```(x,y)``` уравнения вида $y^2 = x^3 + ax + b$ над указанным полем с дополнительной точкой в бесконечности.

В криптографических приложениях, как правило, рассматриваются эллиптические кривые над конечным полем $GF(2^n), n \in \mathbb {N}$

> **Коммутативная группа по операции сложения** - множество точек эллиптической кривой

Пользуясь операцией сложения точек на кривой, можно определить операцию умножения точки ```P``` на произвольное целое число ```n``` : $nP = P + … + P$, где операция сложения выполняется ```n``` раз.

### Однонаправленную функция, на основе которой можно создать криптосистему

- ```P``` — точка эллиптической кривой
- $n \in \mathbb{Z}$, ```n``` > количества точек на эллиптической кривой

$\implies$

```nP``` - прямоя функция, для вычисления потребуется не больше $2\log_{2}n$ операций сложения

Обратную функция: по заданной эллиптической кривой, точке на этой кривой и произведению ```nP``` найти число ```n```

все известные алгоритмы решения этой задачи требуют <ins>экспоненциального времени</ins>

### Криптографический протокол

1. Для установления защищённой связи для пользователя Алиса и Боб совместно выбирают эллиптическую кривую и точку ```P``` на ней.
1. Затем каждый выбирает своё секретное целое число, соответственно ```a``` и ```b```.
1. Алиса вычисляет произведение ```aP```, Боб — ```bP```.
1. Далее они обмениваются полученными значениями. При этом параметры самой кривой, координаты точки на ней и значения произведений являются открытыми и могут передаваться по незащищённым каналам связи.
1. Затем Алиса умножает полученное значение на ```a``` ($a*bP$), а Боб — полученное им значение на ```b``` ($b*aP$).
1. В силу свойств операции умножения на число $abP = baP$. Таким образом, оба пользователя получают общее секретное значение – координаты точки ```abP```, которое они могут использовать для получения ключа шифрования.

Отметим, что злоумышленнику для восстановления ключа потребуется решить сложную вычислительную задачу определения чисел ```a``` и ```b``` по известным эллиптической кривой, точке ```P``` и произведениям ```aP``` и ```bP```.

## Свойства криптосистем с открытым ключом

Протокол портфеля
![[./assets/asymmetrical_1.png]]

- Алиса хочет отправить защищённое сообщение Бобу
- нет доверительных отношений
- сообщение на физическом носителе, Алиса обезопасит его, заперев в портфеле
- Боб ещё не делился ключом с Алисой

### Протокол действий

1. Алиса начинает с получения замка, ключ от которого есть только у Алисы.
1. Алиса помещает сообщение в портфель и закрывает его с помощью своего замка. Запертый портфель она передаёт курьеру, который доставляет его Бобу.
1. Боб получает собственный замок. Как только Боб получает портфель, он добавляет второй замок на портфель и возвращает портфель курьеру, который передаёт его Алисе.
1. Алиса снимает свой замок и вручает портфель курьеру, который снова передаёт его Бобу.
1. Боб снимает свой замок и открывает портфель, чтобы получить сообщение.

Протокол портфеля достигает заявленной цели, потому что сообщение остаётся конфиденциальным в течение трёх своих путешествий между Алисой и Бобом

#### Недостатки

**Аутентификация**
- отсутствие доверительных отношений, таит в себе значительную уязвимость
- нет уверенности в общении с тем, с кем планировалось
- нет аутентификации какого-либо типа

**Эффективность**
- три передачи между Алисой и Бобом (обычно для безопасной передачи сообщения, используют только одну транспортировку)

#### Плюсы

- можно безопасно передать сообщение между двумя сторонами без созданного заранее общего ключа

### Свойства криптосистем из протокла портфеля

- Ключи, используемые для шифрования и расшифрования, должны быть разными
- Любой, кто хочет быть получателем, должен иметь уникальный ключ расшифрования (закрытый ключ)
- Любой, кто хочет быть получателем, должен опубликовать ключ шифрования (открытый ключ)
- Должна быть определённая гарантия подлинности открытого ключа (необходимо быть уверенным в правильном владельце открытого ключа. Сегодня используют сертификаты открытых ключей)
- Не следует допускать получения открытого текста из знания зашифрованного текста и открытого ключа
- Нельзя получить секретный ключ из открытого ключа

## Сравнение криптосистем на эллиптических кривых и криптосистем на основе алгоритма RSA

Криптосистема на основе алгоритма **RSA** и криптосистемы на вариантах **алгоритма Эль-Гамаля**, базирующихся на эллиптических кривых, — наиболее распространённые криптосистемы с открытым ключом.

> **RSA** — криптографический алгоритм с открытым ключом, основывающийся на вычислительной сложности задачи факторизации больших целых чисел

> **Алгоритм Эль-Гамаля** — криптосистема с открытым ключом, основанная на задаче вычисления дискретных логарифмов в конечном поле

| RSA | Алгоритм Эль-Гамаля |
| :--- | :--- |
| предполагает расширение сообщений по умолчанию, что усложняет её использование<br>не являются особенно эффективными | более эффективен для шифрования |
| нужно два возведения в степень | требуется одно возведение в степень |
| расшифрование немного эффективнее<br>выполнение расширенного алгоритма Евклида вычислительно более эффективно | расшифрование менее эффективно, использует возведение в степень|
| медленнее вычислений в симметричных алгоритмах | медленнее вычислений в симметричных алгоритмах |

## Использование криптосистем с открытым ключом

### Ограничения

1. **Вычислительные затраты**<br>
Шифрование и расшифрование с открытым ключом — дорогостоящие для выполнения вычисления. Поэтому в приложениях, где важна скорость обработки данных, часто ограничивают количество выполняемых операций шифрования и расшифрования с открытым ключом. <ins>Cамое важное ограничение</ins>
1. **Проблемы с длинным открытым текстом**
    - Предпологают - открытый текст представляет собой один блок данных
    - более длинный открытый текст, делят на разные блоки, затем зашифровывают их отдельно
    - отдельные блоки зашифровываются с помощью эквивалента открытого ключа в режиме простой замены блочного шифра
    - приводит к возникновению нескольких проблем безопасности
    - ограничить использование шифрования с открытым ключом в одном открытом тексте