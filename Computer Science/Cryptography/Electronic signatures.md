Электронные подписи

# Кратко

Цифровые подписи - это технология, которая использует криптографические методы для создания электронной подписи. Она позволяет проверять подлинность и целостность данных, а также устанавливать конфиденциальность и неотречетность отдельных участников в процессе обмена информацией.

Цифровые подписи используются в различных областях, включая электронную коммерцию, банковскую систему, сертификацию и другие. Основные этапы создания цифровой подписи включают в себя:

1. **Генерация пары ключей**: Каждый пользователь генерирует пару ключей: открытый и закрытый. Открытый ключ используется для шифрования данных, а закрытый ключ - для расшифровки.
    
2. **Создание цифровой подписи**: Отправитель создает цифровую подпись для сообщения, используя свой закрытый ключ. Этот процесс называется "подписью".
    
3. **Проверка цифровой подписи**: Получатель может проверить подлинность сообщения, используя открытый ключ отправителя. Если подпись соответствует сообщению и открытому ключу отправителя, то подпись считается действительной.

---

# Подробно
## Свойства реальных подписей

- **Подпись достоверна**. Она убеждает получателя в том, что человек, подписавший документ, сделал это сознательно
- **Подпись неподдельна**. Она доказывает, что именно подписавший — и никто иной — сознательно подписал документ
- **Подпись невозможно использовать повторно**. Она является частью документа, и злоумышленник не может перенести её в другой документ
- **Подписанный документ невозможно изменить**
- **От подписи нельзя отречься**
- **Подпись и документ материальны**. Подписавший не сможет впоследствии утверждать, что он не подписывал документ

В действительности ни одно из этих утверждений не является бесспорным

## Подписание документов с помощью симметричных криптосистем и посредника

Предположим, что абонент ```А``` хочет подписать цифровое сообщение и отправить его абоненту ```В```, он может это сделать с помощью посредника ```Т``` и симметричной криптосистемы.

Посредник ```Т```
- доверенный всеми сторонами
- может связаться со всеми абонентами
- выдает ```A``` ключ $K_A$
- выдает ```B``` ключ $K_B$

### Последовательность действий абонентов при формировании и проверке электронной подписи с помощью симметричной криптосистемы

1. Абонент ```А``` зашифровывает своё сообщение абоненту В ключом $K_A$ и посылает его посреднику ```Т```.
1. Посредник ```T``` расшифровывает сообщение с использованием ключа $K_A$.
1. Посредник ```T``` включает к расшифрованному сообщению утверждение, что он получил это сообщение от абонента ```А```, и зашифровывает это новое сообщение ключом $K_B$.
1. Посредник ```T``` отправляет новое сообщение абоненту ```В```.
1. Абонент ```В``` расшифровывает сообщение с помощью ключа $K_B$. Теперь он может прочитать и сообщение абонента ```А```, и подтверждение посредника ```Т```, что сообщение отправлено именно абонентом ```А```.

### Характеристики такой подписи

1. **Подпись достоверна**<br>
Так как ```T``` – доверенный посредник, и знает, что сообщение получено именно от абонента А. Подтверждение посредника ```T``` служит доказательством для абонента В.
1. **Подпись неподдельна**<br>
Только абонент ```A``` (и доверенный посредник Т) знает $K_A$, поэтому только абонент ```А```, и никто другой, мог послать посреднику ```T``` сообщение, зашифрованное ключом $K_A$. Если кто-нибудь другой попытается выдать себя за абонента ```А```, посредник ```T``` сразу обнаружит это на этапе 2 и не заверит подлинность.
1. **Подпись невозможно использовать повторно**<br>
- Если абонент ```B``` попытается присоединить подтверждение посредника ```T``` к другому сообщению, абонент ```A``` поднимет скандал.
- Посредник попросит абонента ```B``` предъявить его сообщение и зашифрованное сообщение абонента ```А```.
- Затем посредник зашифрует сообщение ключом $K_A$ и увидит, что оно не совпадает с зашифрованным сообщением, переданным абонентом ```В```. 
- Абонент ```В```, очевидно, не сможет создать правильное зашифрованное сообщение, поскольку он не знает ключ $K_A$.
1. **Подписанный документ невозможно изменить**<br>
Если абонент ```B``` попытается, получив документ, изменить его, посредник ```T``` обнаружит мошенничество описанным выше способом.
1. **От подписи невозможно отказаться**<br>
Если впоследствии абонент ```A``` заявит, что он никогда не отправлял сообщение, подтверждение посредника ```T``` докажет обратное, а посреднику ```T``` доверяют все участники взаимодействия.

### Передача подписанного документа третьему лицу

Если абоненту ```B``` необходимо показать документ, подписанный абонентом ```А```, абоненту ```С```, он не сможет раскрыть ему свой секретный ключ, и ему придётся снова обратиться к посреднику ```Т```

1. Абонент ```В``` берёт сообщение и подтверждение посредника Т, что сообщение получено от абонента ```А```, зашифровывает их ключом $K_B$ и посылает посреднику ```Т```.
1. Посредник ```T``` расшифровывает полученное сообщение с помощью ключа $K_B$.
1. Посредник ```T``` проверяет свою базу данных и подтверждает, что исходное сообщение отправлено абонентом ```А```.
1. Посредник ```T``` зашифровывает полученное от абонента В ключом $K_C$, который он распределил для абонента ```С```, и отправляет абоненту ```С``` зашифрованное сообщение.
1. Абонент ```С``` расшифровывает полученное сообщение с помощью ключа $K_C$. Теперь он может прочитать и сообщение, и подтверждение посредника ```Т```, что сообщение отправлено абонентом ```А```.

Посредник — «узкое место» любой системы связи

## Подписание документов с помощью криптографии с открытым ключом

### Основной протокол

1. Абонент ```А``` зашифровывает документ своим закрытым ключом, тем самым подписывая его.
1. Абонент ```А``` отправляет подписанный документ абоненту ```В```.
1. Абонент ```В``` расшифровывает документ с помощью открытого ключа абонента ```А```, проверяя тем самым достоверность подписи.

### Отвечает всем требованиям к подписи

1.  **Подпись достоверна**<br>
Когда абонент ```B``` проверит подлинность сообщения с помощью открытого ключа абонента ```A```, он узнает, что это сообщение подписал именно абонент ```А```.
1.  **Подпись неподдельна**<br>
Только абонент ```А``` знает свой закрытый ключ.
1.  **Подпись невозможно использовать повторно**<br>
Подпись является встроенной функцией документа и не может быть перенесена в другой документ.
1.  **Подписанный документ нельзя изменить**<br>
После любого изменения документа подпись невозможно больше подтвердить открытым ключом абонента ```А```.
1.  **От подписи невозможно отказаться**<br>
Абоненту ```В``` не требуется помощь абонента ```А``` при проверке его подписи.

## Подписание документа с метками времени

В определённых обстоятельствах абонент В может смошенничать. Например, он может повторно использовать подписанный документ. Если абонент А подписал контракт, это не проблема — не имеет значения, сколько копий контракта существует. Однако если абонент А подписал электронный чек, мошенничество абонента В повлечёт финансовые потери абонента А.

Поэтому в электронные подписи часто вставляют метки времени. В документ включают дату и время подписания, после чего подписывают вместе со всем содержимым сообщения

## Подписание документа с помощью криптографии с открытым ключом и однонаправленных хэш-функций

- В практических реализациях алгоритмы с открытым ключом нередко малоэффективны для подписания больших документов
- для подтверждения целостности сообщения требуется много памяти

> вместо подписания самого документа подписывается хэш-значение этого документа

однонаправленная хэш-функция и алгоритм электронной подписи должны быть согласованы заранее

1.  Абонент ```A``` создает необратимое хэш-значение документа.
1.  Абонент ```A``` зашифровывает это значение своим закрытым ключом, тем самым подписывая документ.
1.  Абонент ```A``` отправляет абоненту ```B``` документ и подписанное хэш-значение.
1.  Абонент ```B``` генерирует необратимое хэш-значение документа, присланного абонентом ```А```.
    - Затем, используя алгоритм электронной подписи, абонент ```B``` расшифровывает подписанное хэш-значение документа с помощью открытого ключа абонента ```А```.
    - Если подписанное хэш-значение совпадает со сгенерированным — подпись достоверна

> должна использоваться только однонаправленная хэш-функция

### Преимущества

- Более быстрые и затратные операции
- подпись можно хранить отдельно от документа
- значительно снижаются требования к объёму памяти на стороне получателя, необходимой для хранения документов и подписей
- Система архивирования может использовать этот протокол для подтверждения существования документов без сохранения их содержимого
- высокая конфиденциальность

## Многократные подписи

решается с помощью однонаправленных хэш‑функций:

1. Абонент А подписывает значение хэш‑функции документа.
1. Абонент В подписывает значение хэш‑функции документа.
1. Абонент В отправляет свою подпись абоненту А.
1. Абонент А отправляет абоненту С сам документ, свою подпись и подпись абонента В.
1. Абонент С проверяет подписи абонентов А и В.

Абоненты А и В могут выполнить шаги 1 и 2 как параллельно, так и последовательно. На шаге 5 абонент С может проверить любую подпись независимо от другой.

## Неотказуемость от авторства и электронные подписи

Абонент А может смошенничать с электронными подписями, и с этим ничего нельзя поделать. Так, он может подписать документ и затем утверждать, что он этого не делал.

Это называется отказ от подписи или отрицание авторства.

Метки времени могут снизить эффективность такого мошенничества. Однако абонент А всегда может заявить, что его ключ был скомпрометирован раньше

### Общая схема протокола

1. Абонент ```А``` подписывает сообщение.
1. Абонент генерирует заголовок, содержащий некоторую идентификационную информацию. Затем он присоединяет заголовок к подписанному сообщению, подписывает всё вместе и отправляет посреднику ```Т```.
1. Посредник ```Т``` проверяет подлинность внешней подписи и подтверждает идентификационную информацию. Далее он проставляет метку времени на сообщении, подписанном абонентом ```А```, и на идентификационной информации. Затем он подписывает всё сообщение и отправляет его абонентам ```А``` и ```В```.
1. Абонент ```В``` проверяет подлинность подписи посредника ```Т```, идентификационную информацию и подпись абонента ```A```.
1. Абонент ```А``` проверяет подлинность сообщения, которое посредник Т отправлял абоненту В. Если абонент ```А``` не признаёт свое авторство, он немедленно заявляет об этом.

Существует и другая схема, в которой посредник Т вступает в протокол после факта подписания:
- Получив подписанное сообщение, абонент В отправляет копию посреднику для проверки
- Посредник может засвидетельствовать подлинность подписи абонента А.

# 4. Нормативные аспекты применения электронной подписи

## Основные документы, регламентирующие использование электронной подписи

> **Удостоверяющий центр (УЦ)**
>
> юридическое лицо, индивидуальный предприниматель либо государственный орган или орган местного самоуправления, создающие и выдающие сертификаты ключей проверки электронных подписей, а также выполняющие иные функции, предусмотренные Федеральным законом «Об электронной подписи».

1. Федеральный закон № [63-ФЗ «Об электронной подписи»](https://www.consultant.ru/document/cons_doc_LAW_112701/).
1. Требования к средствам электронной подписи ([приложение № 1 к приказу ФСБ РФ от 27 декабря 2011 г. № 796 «Об утверждении Требований к средствам электронной подписи и Требований к средствам удостоверяющего центра»](https://base.garant.ru/70139150/ad65a43c549a45d32360a363f5d4fa2c/#block_66)).
1. Требования к средствам удостоверяющего центра ([приложение № 2 к приказу ФСБ РФ от 27 декабря 2011 г. № 796 «Об утверждении Требований к средствам электронной подписи и Требований к средствам удостоверяющего центра»](https://base.garant.ru/70139150/563198f2b81e68dd907ddc26c916e9b0/#block_222)).

## Федеральный закон «Об электронной подписи»

Регулирует отношения области использования ЭП при совершении
- гражданско-правовых сделок
- оказании государственных и муниципальных услуг
- исполнении государственных и муниципальных функций
- при совершении иных юридически значимых действий.

Порядок использования ЭП в корпоративной информационной системе может устанавливаться оператором этой системы или соглашением между участниками электронного взаимодействия в ней, если иное не установлено федеральными законами, принимаемыми в соответствии с ними нормативными правовыми актами или решением о создании корпоративной информационной системы.

Правительство Российской Федерации устанавливает:
- Виды ЭП, используемых органами исполнительной власти и органами местного самоуправления
- порядок их использования
- требования об обеспечении совместимости средств ЭП при организации электронного взаимодействия органов между собой

## Требования к средствам ЭП

Предназначены для
- заказчиков и разработчиков разрабатываемых (модернизируемых) средств ЭП при их взаимодействии между собой;
- с организациями, проводящими криптографические, инженерно-криптографические и специальные исследования средств ЭП;
- ФСБ России, подтверждающей соответствия средств ЭП требованиям

Требования распространяются на средства ЭП
- предназначенные для использования на территории Российской Федерации
- в учреждениях Российской Федерации за рубежом и в находящихся за рубежом обособленных подразделениях юридических лиц, образованных в соответствии с законодательством Российской Федерации.

Требования, предъявляемые к средствам ЭП в части их разработки, производства, реализации и эксплуатации должны соответствовать [Положению ПКЗ-2005](https://base.garant.ru/187947/53f89421bbdaf741eb2d1ecc4ddb4c33/#block_1000).

## Требования к средствам УЦ

Предназначены для
- заказчиков и разработчиков разрабатываемых (модернизируемых) средств УЦ при их взаимодействии между собой
- с организациями, проводящими криптографические, инженерно-криптографические и специальные исследования средств УЦ;
- ФСБ России, подтверждающей соответствия средств УЦ указанным требованиям.

Требования к средствам УЦ распространяются на средства УЦ, предназначенные для использования на территории Российской Федерации.

Требования к средствам УЦ, касающиеся их разработки, производства, реализации и эксплуатации должны соответствовать Положению ПКЗ-2005.

## Общие вопросы использования электронной подписи

Федеральный закон «Об электронной подписи» устанавливает следующие принципы использования ЭП:

1. Право участников электронного взаимодействия использовать ЭП любого вида по своему усмотрению. При условии, что требование об использовании конкретного вида ЭП в соответствии с целями её использования не предусмотрено федеральными законами или принимаемыми в соответствии с ними нормативными правовыми актами либо соглашением между участниками электронного взаимодействия.
2. Возможность использования участниками электронного взаимодействия по своему усмотрению любой информационной технологии и (или) технических средств, позволяющих выполнить требования указанного закона.
3. Недопустимость признания ЭП и (или) подписанного ей электронного документа не имеющими юридической силы только на основании того, что такая ЭП создана не собственноручно, а с использованием средств ЭП для автоматического создания и (или) автоматической проверки ЭП в информационной системе.

![[./_/02_04_sign_types.png]]

### Простая ЭП

ЭП, которая посредством использования кодов, паролей или иных средств подтверждает факт формирования ЭП определенным лицом.

### Неквалифицированная ЭП

ЭП, обладающая следующими свойствами:
1. получена в результате криптографического преобразования информации с использованием ключа ЭП;
1. позволяет определить лицо, подписавшее электронный документ;
1. позволяет обнаружить факт внесения изменений в электронный документ после момента его подписания;
1. создаётся с использованием средств ЭП.

При использовании неквалифицированной ЭП допускается не создавать сертификат ключа проверки ЭП, если выполняются все необходимые свойства.

### Квалифицированная ЭП

ЭП, обладающая всеми свойствами неквалифицированной ЭП и следующими свойствами:
1. ключ проверки ЭП указан в квалифицированном сертификате;
1. для создания и проверки ЭП используются средства ЭП, получившие подтверждение соответствия требованиям, установленным в соответствии с законом «Об электронной подписи».

информация в электронной форме, подписанная квалифицированной ЭП, признаётся электронным документом, равнозначным документу на бумажном носителе, подписанному собственноручной подписью.

#### признаётся действительной при одновременном соблюдении следующих условий

1. Квалифицированный сертификат создан и выдан аккредитованным УЦ; его аккредитация должна быть действительна на день выдачи указанного сертификата.
1. Квалифицированный сертификат действителен на момент подписания электронного документа или на день проверки действительности указанного сертификата, если момент подписания электронного документа не определён.
1. Подтверждена принадлежность владельцу квалифицированного сертификата квалифицированной ЭП, с помощью которой подписан электронный документ; подтверждено отсутствие изменений, внесённых в этот документ после его подписания;
1. Квалифицированная ЭП используется с учётом ограничений, содержащихся в квалифицированном сертификате лица, подписывающего электронный документ, если такие ограничения установлены.

### Усиленная ЭП

Если документ должен быть заверен печатью, электронный документ, подписанный усиленной ЭП и признаваемый равнозначным документу на бумажном носителе, подписанному собственноручно, признаётся равнозначным документу на бумажном носителе, подписанному собственноручно и заверенному печатью.

#### обязанности участников электронного взаимодействия

1. обеспечивать конфиденциальность ключей ЭП;
1. уведомлять УЦ, выдавший сертификат ключа проверки ЭП, и иных участников электронного взаимодействия о нарушении конфиденциальности ключа ЭП;
1. прекратить использование ключа при наличии оснований полагать, что конфиденциальность этого ключа нарушена;
1. использовать для создания и проверки квалифицированных ЭП, создания ключей квалифицированных ЭП и ключей их проверки средства ЭП, соответствующие требованиям закона «Об электронной подписи».

## Общие вопросы функционирования удостоверяющего центра

### основные функции УЦ:

1. создание сертификатов ключей проверки ЭП и выдача их заявителям;
1. установка сроков действия сертификатов ключей проверки ЭП;
1. аннулирование выданных этим УЦ сертификатов ключей проверки ЭП;
1. выдача заявителю средств ЭП, содержащих ключ ЭП и ключ проверки ЭП;
1. ведение реестра выданных и аннулированных этим УЦ сертификатов;
1. создание ключей ЭП и ключей проверки ЭП;
1. проверка уникальности ключей проверки ЭП;
1. проверка ЭП по обращениям участников электронного взаимодействия.

### обязанности УЦ (Закон «Об электронной подписи»)

1. Информировать в письменной форме заявителей об условиях и о порядке использования ЭП и средств ЭП, о рисках, связанных с использованием ЭП, и о мерах, необходимых для обеспечения безопасности ЭП и их проверки;
1. обеспечивать актуальность информации, содержащейся в реестре сертификатов, и ее защиту от неправомерного доступа, уничтожения, модификации, блокирования, иных неправомерных действий;
1. предоставлять безвозмездно любому лицу по его обращению в соответствии с установленным порядком доступа к реестру сертификатов информацию, содержащуюся в реестре сертификатов;
1. обеспечивать конфиденциальность созданных УЦ ключей ЭП.

УЦ создаёт и выдаёт сертификат ключа проверки ЭП на основании соглашения между удостоверяющим центром и заявителем.

### Аккредитованный УЦ

#### обязан хранить следующие данные:

1. Для физического лица — реквизиты основного документа, удостоверяющего личность владельца квалифицированного сертификата.
1. Для юридического лица — сведения о наименовании, номере и дате выдачи документа, подтверждающего право лица, выступающего от имени заявителя, обращаться за получением квалифицированного сертификата.
1. Сведения о наименованиях, номерах и датах выдачи документов, подтверждающих полномочия владельца квалифицированного сертификата действовать по поручению третьих лиц, если информация о таких полномочиях владельца включена в квалифицированный сертификат.

Аккредитованный УЦ обязан обеспечить любому лицу безвозмездный доступ к выданным этим УЦ квалифицированным сертификатам и к актуальному списку аннулированных квалифицированных сертификатов в любое время в течение срока деятельности этого удостоверяющего центра.

#### В случае принятия решения о прекращении своей деятельности аккредитованный УЦ обязан:

1. Сообщить об этом в уполномоченный федеральный орган не позднее чем за один месяц до даты прекращения своей деятельности.
1. Передать в уполномоченный федеральный орган в установленном порядке реестр квалифицированных сертификатов.
1. Передать на хранение в уполномоченный федеральный орган в установленном порядке информацию, подлежащую хранению в аккредитованном УЦ.

#### При выдаче квалифицированного сертификата аккредитованный УЦ обязан:

- Для физического лица, обратившегося к нему за получением квалифицированного сертификата, — установить его личность.
- Для юридического лица — получить от лица, выступающего от имени заявителя, подтверждение правомочия обращаться за получением квалифицированного сертификата.

## Придание юридической значимости электронному документу

Понятие юридической силы документа определено стандартом ГОСТ Р 51141-98 «Делопроизводство и архивное дело. Термины и определения»

Взамен настоящего ГОСТа приказом Росстандарта от 17 октября 2013 г. N 1185-ст с 1 марта 2014 г. введен в действие [ГОСТ Р 7.0.8-2013](https://base.garant.ru/70650732/)

Таким образом, юридическая значимость электронного документа является необходимым, но недостаточным условием приобретения им юридической силы.