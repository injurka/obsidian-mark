## Что такое декораторы

Декоратор — это специальный вид объявления, который может быть присоединен к объявлению класса, метода, аксессора, свойства или параметра. Декораторы используют форму `@expression`, где `expression` должно оценивать функцию, которая будет вызываться во время выполнения с информацией о декорированном объявлении.

Декораторы были впервые представлены в **TypeScript** как экспериментальная функция в версии 1.5 (выпущенной в июле 2015 года). Их целью было обеспечить более удобный и декларативный способ добавления метаданных и поведения к существующему коду, что особенно полезно в контексте метапрограммирования и создания фреймворков.

### tsconfig.json

При работе над проектом с файлом `tsconfig.json`, для включения экспериментальных декораторов необходимо добавить свойство `experimentalDecorators` в объект `compilerOptions`:

```json
{
  "compilerOptions": {
    "experimentalDecorators": true
  }
}
```

В TypeScript Playground декораторы включены по умолчанию.

## [[Types of decorators|Виды декораторов]]

В TypeScript можно создавать декораторы с помощью специального синтаксиса `@expression`, где `expression` — это функция, которая будет вызываться автоматически во время выполнения с деталями о цели декоратора.

Целью декоратора зависит от того, где вы их добавляете. В настоящее время декораторы могут быть добавлены к следующим компонентам класса:

- ### [[Class decorators]]
- ### [[Property decorators]]
- ### [[Accessor decorators]]
- ### [[Method decorators]]
- ### [[Parameter decorators]]

## [[Advanced decorator patterns|Продвинутые шаблоны декораторов]]

В TypeScript такие продвинутые шаблоны декораторов, как композиция декораторов и фабрики, обеспечивают гибкость и повторное использование при применении декораторов к классам, методам и свойствам.

- ### [[Decorator factory]]
- ### [[Decorator composition]]
- ### [[Automatic error guard]]

## [[Cheatsheet|Готовые рецепты декораторов]]

Конкретные реализованые задачи, которые декораторы могут помочь улучшить:

- ### [[Calculating execution time]]

## Декораторы в JavaScript vs TypeScript

### Объекты для декорирования

Декораторы в TypeScript значительно отличаются от декораторов в JavaScript. Первое важное различие касается объектов, которые можно декорировать. TypeScript позволяет аннотировать и модифицировать объявления классов, методы, свойства, аксессоры и параметры.

В TypeScript 5.0 представлена новая реализация поддержки декораторов, соответствующая предложению ECMAScript на стадии три. Однако в настоящее время она не поддерживает декорирование параметров, но это может измениться в будущих предложениях ECMAScript. Старые декораторы TypeScript поддерживают декорирование параметров. В JavaScript, с другой стороны, можно декорировать только объявления классов и методы.

### Проверка типов

Второе важное различие между декораторами в JavaScript и TypeScript — это проверка типов. Поскольку TypeScript — это строго типизированный язык программирования, он может проверять типы параметров и возвращаемые значения декораторных функций. JavaScript не имеет такой проверки типов и требует использования проверок во время выполнения или внешних инструментов, таких как линтеры, для выявления ошибок типов.

## Новые декораторы в TypeScript

В TypeScript декораторы — это функции, которые могут быть присоединены к классам и их членам, таким как методы и свойства.

### Новый стиль декораторов

Новый тип `Decorator` определяется следующим образом:

```typescript
type Decorator = (target: Input, context: {
  kind: string;
  name: string | symbol;
  access: {
    get?(): unknown;
    set?(value: unknown): void;
  };
  private?: boolean;
  static?: boolean;
  addInitializer?(initializer: () => void): void;
}) => Output | void;
```

Определение типа выглядит сложным, поэтому давайте разберем его по частям:

- `target` представляет элемент, который мы декорируем, тип которого — `Input`.
- `context` содержит метаданные о том, как был объявлен декорируемый метод, а именно:
  - `kind`: Тип декорируемого значения. Как мы увидим, это может быть `class`, `method`, `getter`, `setter`, `field` или `accessor`.
  - `name`: Имя декорируемого объекта.
  - `access`: Объект с ссылками на методы геттера и сеттера для доступа к декорируемому объекту.
  - `private`: Является ли декорируемый объект приватным членом класса.
  - `static`: Является ли декорируемый объект статическим членом класса.
  - `addInitializer`: Способ добавления пользовательской логики инициализации в начале конструктора (или при определении класса).
- `Output` представляет тип значения, возвращаемого функцией `Decorator`.

## Источники
- #### [logrocket](https://blog.logrocket.com/practical-guide-typescript-decorators/)

