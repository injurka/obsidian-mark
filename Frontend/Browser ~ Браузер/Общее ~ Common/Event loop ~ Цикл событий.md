Это механизм в JavaScript, который контролирует порядок выполнения кода и обработку событий в однопоточной среде. Он позволяет JavaScript выполнять асинхронные операции, такие как обработка событий пользовательского ввода, таймеры и запросы к серверу, без блокировки основного потока выполнения.

Код каждой HTML-страницы в браузере выполняется в Main Thread. Main Thread — это основной поток, где браузер выполняет JS, делает перерисовки, обрабатывает пользовательские действия и многое другое. По сути, это то место, где движок JS интегрирован в браузер.

![[event-loop.png]]

#### Как работает?
Event loop состоит из нескольких фаз, каждая из которых выполняет определенные задачи. По умолчанию, JavaScript начинает выполнение кода в глобальной области видимости, а затем переходит к обработке событий в цикле событий.

1. Фаза выполнения синхронного кода: В этой фазе JavaScript выполняет синхронный код, который находится в глобальной области видимости или вызывается из других функций. JavaScript выполняет код последовательно, по одной операции за раз. В этой фазе JavaScript выполняет все операции, которые не требуют асинхронной обработки или ожидания.
2. Фаза выполнения микрозадач (Microtasks): После выполнения синхронного кода, JavaScript переходит к выполнению микрозадач, которые были поставлены в очередь в предыдущих фазах. Микрозадачи имеют более высокий приоритет, чем макрозадачи, и выполняются максимально быстро. Микрозадачи могут быть добавлены в очередь с помощью методов промисов (`then`, `catch`, `finally`), мутаций DOM (`MutationObserver`) или других асинхронных операций.
3. Фаза обработки событий (Event processing): В этой фазе JavaScript обрабатывает события, которые произошли во время выполнения кода. Это может быть событие пользовательского ввода (например, клик мыши или нажатие клавиши), таймеры (`setTimeout`, `setInterval`) или другие асинхронные операции. JavaScript проверяет очередь событий и вызывает соответствующие обработчики событий. Обработчики событий выполняются в порядке их добавления в очередь.
4. Фаза выполнения макрозадач (Macrotasks): После обработки всех событий, JavaScript переходит к выполнению макрозадач, которые были поставлены в очередь в предыдущей фазе. Макрозадачи имеют более низкий приоритет, чем микрозадачи, и выполняются с задержкой. Макрозадачи могут быть добавлены в очередь с помощью таймеров (`setTimeout`, `setInterval`), запросов к серверу или других асинхронных операций.
5. Фаза отрисовки (Rendering): В конце каждой итерации цикла событий, если есть изменения в DOM или графическом интерфейсе, происходит фаза отрисовки, где браузер обновляет отображение страницы, чтобы отобразить эти изменения. Это позволяет браузеру отображать обновления пользовательского интерфейса без блокировки основного потока выполнения JavaScript.

После завершения фазы отрисовки, цикл событий начинается снова с фазы выполнения синхронного кода. Этот процесс повторяется до тех пор, пока есть задачи в очередях микрозадач и макрозадач.

Event loop позволяет JavaScript выполнять асинхронные операции, не блокируя основной поток выполнения. Это позволяет создавать отзывчивые и интерактивные веб-приложения. Однако, важно понимать порядок выполнения кода и как работает

#### Движок JavaScript
- V8 - Chrome
- JavaScriptCore - Safari
- Chakra - microsoft edge 
- SpiderMonkey - mozilla

#### Что решает?
- Куча (heap) и стек вызовов (call stack)
- Работа с памятью (выделение и сбор мусора)
- Компиляция JS в машинный код
- Оптимизация (кеши, скрытые классы и прочее)