---
tags:
  - linux
---
## **ps / pgrep**

Команда `ps` выдает информацию об активных процессах. По умолчанию информация дается только о процессах, ассоциированных с данным терминалом. Выводятся идентификатор процесса, идентификатор терминала, истраченное к данному моменту время ЦП и имя команды. Если нужна иная информация, следует пользоваться опциями. Одна из самых распространенных комбинаций флагов: `ps aux` Выводятся все процессы, выполняющиеся от имени всех пользователей (выводит статистику, время старта процесса и команду, которая его стартовала)

![[../_/ps-out.png]]

### Поля, которые входят в вывод команды `ps`

- **PID** — идентификатор процесса.
- **TTY** — терминальное устройство, на котором выполняется процесс. Подробнее об этом позже.
- **STAT** — состояние (status) процесса, то есть информация о том, что делает процесс и где находится его память. Например, `S` означает, что процесс приостановлен (sleeping), а `R` — что он запущен (running) (описание всех символов см. на странице руководства `ps(1)`).
- **TIME** — количество процессорного времени в минутах и секундах, которое процесс успел использовать. Другими словами, общее количество времени, которое процессор потратил на выполнение инструкций процесса. Помните, что поскольку процессы не выполняются постоянно, значение отличается от времени, прошедшего с момента запуска процесса (или времени настенных часов — wall-clock time).
- **COMMAND** — очевидно, это команда, используемая для запуска программы, однако имейте в виду, что процесс может изменить это поле по сравнению с его исходным значением. Кроме того, оболочка может выполнять расширение шаблона, и это поле будет отражать расширенную команду, а не то, что вы вводите в командной строке.

**ПРИМЕЧАНИЕ**
Идентификаторы PID уникальны для каждого процесса, запущенного в системе. Однако после завершения процесса ядро может повторно применить тот же PID для нового процесса.

### Параметры команды `ps`

Команда `ps` имеет множество параметров. Они могут различаться в стилях Unix, BSD и GNU. Многие пользователи считают стиль BSD наиболее удобным (возможно, потому что он требует меньшего набора текста), поэтому именно его мы будем применять в этой книге. Вот некоторые из наиболее полезных комбинаций параметров:

- `ps x` — отображает все запущенные вами процессы.
- `ps ax` — выводит все процессы в системе, а не только ваши.
- `ps u` — отображает более подробную информацию о процессах.
- `ps w` — выводит полные имена команд, а не только то, что помещается в одной строке.

Как и в других командах, вы можете комбинировать параметры, образуя `ps aux` и `ps auxw`.

Чтобы проверить конкретный процесс, добавьте его PID в список аргументов команды `ps`. Например, для проверки текущего процесса оболочки можно использовать `ps` и `$$` (`$$` — это переменная оболочки, которая содержит PID текущей оболочки).

Информация о командах администрирования `top` и `lsof` дается в главе 8. Они могут быть полезны для определения местоположения процессов, даже если вы занимаетесь чем-то, кроме обслуживания системы.

## **kill / xkill / pkill / killall**

Все они служат для завершения процессов. Но они принимают различные параметры для идентификации процессов. **Kill** нужен PID процесса, xkill - достаточно кликнуть по окну, чтобы закрыть его, **killall** и **pkill** принимают имя процесса.

**Команда killall** в Linux предназначена для «убийства» всех процессов, имеющих одно и то же имя. Это удобно, так как нам не нужно знать PID процесса. Например, мы хотим закрыть все процессы с именем gcalctool. Выполните в терминале:

```bash
killall gcalctool
```

Команда killall, так же как и kill, по умолчанию шлет сигнал SIGTERM. Чтобы послать другой сигнал нужно воспользоваться опцией _-s_. Например:

```bash
killall -s 9 gcalctool
```

Когда вы выполняете команду "kill", то фактически вы посылаете системе сигнал, чтобы заставить ее завершить некорректно ведущее себя приложение. Всего вы можете использовать до 60 сигналов, но все, что нужно знать, это SIGTERM (15) и SIGKILL (9).

**SIGTERM** – Этот сигнал запрашивает остановку процесса который работает. Этот сигнал может быть проигнорирован. Процессу дается время, чтобы хорошо выключился. Когда программа хорошо выключается, это означает, что ей дано время, чтобы спасти его прогресс и освободить ресурсы. Другими словами, он не «forced» прекращение работы процесса.

**SIGKILL** – сигнал SIGKILL заставляет процесс прекратить выполнение своей работы немедленно. Программа не может игнорировать этот сигнал. Несохраненный прогресс будет потерян.

Вы можете просмотреть все сигналы с помощью команды:

```bash
$ kill -l
```

Вот некоторые:

| N   | Имя  | Описание                                                                                                                                                                                                      | Можно перехватывать | Можно блокировать |
| --- | ---- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------- | ----------------- |
| 1   | HUP  | Hangup. Отбой                                                                                                                                                                                                 | Да                  | Да                |
| 2   | INT  | Interrupt. В случае выполнения простых команд вызывает прекращение выполнения, в интерактивных программах - прекращение активного процесса                                                                    | Да                  | Да                |
| 3   | QUIT | Как правило, сильнее сигнала Interrupt                                                                                                                                                                        | Да                  | Да                |
| 4   | ILL  | Illegal Instruction. Центральный процессор столкнулся с незнакомой командой (в большинстве случаев это означает, что допущена программная ошибка). Сигнал отправляется программе, в которой возникла проблема | Да                  | Да                |
| 8   | FPE  | Floating Point Exception. Вычислительная ошибка, например, деление на ноль                                                                                                                                    | Да                  | Да                |
| 9   | KILL | Всегда прекращает выполнение процесса                                                                                                                                                                         | Нет                 | Нет               |
| 11  | SEGV | Segmentation Violation. Доступ к недозволенной области памяти                                                                                                                                                 | Да                  | Да                |
| 13  | PIPE | Была предпринята попытка передачи данных с помощью конвейера или очереди FIFO, однако не существует процесса, способного принять эти данные                                                                   | Да                  | Да                |
| 15  | TERM | Software Termination. Требование закончить процесс (программное завершение)                                                                                                                                   | Да                  | Да                |

## **top / htop**

Обе команды похожи, обе отображают процессы, и могут быть использованы как консольные системные мониторы. Я рекомендую установить htop, если в вашем дистрибутиве он не поставляется по умолчанию, так как это намного улучшенная версия top. Вы сможете не только просматривать, но и контролировать процессы через его интерактивный интерфейс.

## **time**

Время выполнения процесса. Это секундомер для выполнения программы. Полезно если вам интересно насколько сильно ваша реализация алгоритма отстает от стандартной. Но несмотря на такое название она не сообщит вам текущее время, используйте для этого команду date.