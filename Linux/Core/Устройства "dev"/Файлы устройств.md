Управлять большинством устройств в системе Unix легко, поскольку ядро представляет множество интерфейсов ввода-вывода устройств пользовательским процессам в виде файлов. Эти файлы устройств иногда называют *узлами устройств*.

Некоторые устройства доступны не только программистам, применяющим обычные файловые операции для работы с ними, но и стандартным программам, таким как `cat`, поэтому вам не нужно быть программистом, чтобы использовать устройства. Однако существует ограничение на то, что можно сделать с файловым интерфейсом, поэтому не все устройства или возможности устройств доступны в стандартном файловом вводе-выводе.

Система Linux использует тот же дизайн для файлов устройств, что и другие системы Unix. Файлы устройств находятся в каталоге `/dev`, и запуск команды `ls /dev` отображает довольно много файлов в `/dev`. Итак, как же работать с устройствами?

Для начала рассмотрим команду:
```bash
$ echo blah blah > /dev/null
```
Как и любая другая команда с перенаправленным выводом, она отправляет данные из стандартного вывода в файл. Однако файл является устройством `/dev/null`, поэтому ядро отказывается от своих обычных файловых операций и использует драйвер устройства для данных, записанных на это устройство. В случае с `/dev/null` ядро просто принимает входные данные и отбрасывает их.

Чтобы идентифицировать устройство и просмотреть его права доступа, применяйте команду `ls -l`. Вот несколько примеров:
```bash
$ ls -l
brw-rw---- 1 root disk 8, 1 Sep 6 08:37 sda1
crw-rw-rw- 1 root root 1, 3 Sep 6 08:37 null
prw-r--r-- 1 root root 0 Mar 3 19:17 fdata
srw-rw-rw- 1 root root 0 Dec 18 07:43 log
```
Обратите внимание на первый символ каждой строки (первый символ режима файла). Если это символы `b`, `c`, `p` или `s`, то файл является устройством. Эти буквы обозначают **block** (блочное устройство), **character** (символьное устройство), **pipe** (конвейер) и **socket** (сокет) соответственно.

## Типы устройств

### Блочное устройство
Программы получают доступ к данным с блочного устройства фиксированными частями. Устройство `sda1` в приведенном ранее примере — это дисковое устройство, тип блочного устройства. Диски можно легко разбить на блоки данных. Поскольку общий размер блочного устройства фиксирован и его легко индексировать, процессы имеют быстрый произвольный доступ к любому блоку в устройстве с помощью ядра.

### Символьное устройство
Символьные устройства работают с потоками данных. Вы можете считывать символы с символьных устройств или записывать их на символьные устройства, как было показано ранее на устройстве `/dev/null`. Символьные устройства не имеют размера: когда вы читаете из одного из них или записываете в него, ядро обычно выполняет на нем операцию чтения или записи. Принтеры, непосредственно подключенные к компьютеру, представляются символьными устройствами. Важно отметить, что во время взаимодействия с символьным устройством ядро не может создавать резервные копии и повторно выполнять проверку после передачи данных устройству или процессу.

### Конвейер
Именованный конвейер по структуре такой же, как символьные устройства, но с другим процессом на другом конце потока ввода-вывода вместо драйвера ядра.

### Сокет
Сокеты — это специальные интерфейсы, которые используются для межпроцессной связи. Они часто находятся за пределами каталога `/dev`. Файлы сокетов представляют собой доменные сокеты Unix, подробнее о них вы узнаете в главе 10.

В списках файлов вывода команды `ls -l` с блочных и символьных устройств номера перед датами являются основными (major) и второстепенными (minor) номерами устройств, которые ядро использует для их идентификации. Подобные устройства обычно имеют одинаковое основное число, например `sda3` и `sdb1` (оба являются разделами жесткого диска).

> [!WARN] Примечание
> Не у всех устройств есть файлы, поскольку интерфейсы ввода-вывода блочных и символьных устройств подходят не во всех случаях. Например, сетевые интерфейсы не содержат файлов устройств. Теоретически возможно взаимодействовать с сетевым интерфейсом с помощью одного символьного устройства, но поскольку это проблематично, ядро предлагает другие интерфейсы ввода-вывода.

---
- #### Книга  `Уорд Б. У64 Внутреннее устройство Linux. 3-е изд. — СПб.: Питер, 2022. — 480 с.: ил. — (Серия «Для профессионалов»)`