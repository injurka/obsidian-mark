В следующем примере у нас есть схема эффекта огня на нашем уровне (который является актером), и мы хотим, чтобы он взаимодействовал с моделью игрового персонажа, которую использует игрок. Когда игрок попадает в огонь, мы хотим послать сигнал на схему персонажа о том, что игрок попал в огонь и что теперь он должен получить урон. Используя возвращаемое значение события перекрытия, мы можем применить его к нашей схеме символов и получить доступ к Событиям, функциям или переменным внутри нее.

- Эффект огня, описанный выше, является активом `Blueprint_Effect_Fire` (входит в стартовый контент).
- Компонент сферы с именем *Trigger* был добавлен в **Blueprint** и был настроен так, чтобы перекрывать только *Pawn* при столкновении.

Используя Blueprint Casting, мы бы сделали следующее:

1. Схема персонажа, назначенная **Default Pawn Class** (игровому персонажу), является нашей целевой схемой, к которой мы хотим получить доступ.
    
    ![](https://d1iv7db44yhgxn.cloudfront.net/documentation/images/f6e10e96-5411-4665-9b48-d0f0fa788058/3_0b.png)
    
    Вы можете просмотреть класс пешки по умолчанию в меню "Правка" в разделе "Настройки проекта" в разделе "Карты и режимы".
    
2. Теперь, когда мы знаем, что наша цель - **MyCharacter** Blueprint, внутри него мы создаем переменную **Bool**, которая указывает, горит ли игрок
    
    ![](https://d1iv7db44yhgxn.cloudfront.net/documentation/images/7fe70263-0051-45a9-abd3-9a7c80daec41/3_0c.png)
    
    Над **галочкой события** отображается **Ветка**, где, если **True**, мы выводим **Применить урон** на экран (off True - это то место, где у вас должен быть сценарий применения урона).
    
3. Внутри **Blueprint_Effect_Fire** Blueprint мы добавляем два события для **триггера**: **OnComponentBeginOverlap** и **OnComponentEndOverlap**.
    
    ![](https://d1iv7db44yhgxn.cloudfront.net/documentation/images/e7a9b050-63dc-4c64-ace3-46b6353d364e/3_1.png)
4. После добавления событий мы убираем пин-код **Другого актера** и вводим **Актерский состав на мой** в поле поиска.
    
    ![](https://d1iv7db44yhgxn.cloudfront.net/documentation/images/1cd96da7-4a53-4bb7-a990-68c5ceb68cf2/3_2.png)
    
    Здесь мы проверяем/назначаем актера (MyCharacter Blueprint), который должен инициировать событие, и **Cast To**, чтобы мы могли получить к нему доступ в рамках fire Blueprint.
    
5. Выберите опцию **Cast To MyCharacter**.
    
6. С добавлением узла мы можем перетащить значок **As My Character C** и получить доступ к событиям, переменным, функциям и т.д. внутри него (в данном случае **Set Is on Fire**).
    
    ![](https://d1iv7db44yhgxn.cloudfront.net/documentation/images/91fa62a0-e7f5-4cfa-b466-7b5cfe16b237/3_3.png)
7. Both Events in the **Blueprint_Effect_Fire** Blueprint would then look like this.
    
    ![](https://d1iv7db44yhgxn.cloudfront.net/documentation/images/9292b82b-1153-43ba-a531-c79c0380f865/3_4.png)
    
   При перекрытии fire мы устанавливаем переменную **IsOnFire** в схеме **MyCharacter** в значение **True** и устанавливаем ее в значение **False**, если она не перекрывается. Внутри **MyCharacter** Blueprint, когда для **IsOnFire** установлено значение **True** с помощью fire Blueprint, мы выводим на экран **Apply Damage** (или, если вы создали систему "Здоровье/урон", вы можете наносить урон и уменьшать здоровье игрока здесь).

## Other Types of Casting

Существуют некоторые специальные функции, которые можно использовать для **Cast To** различным классификациям **Blueprints**.

![[othercasting.png]]

На приведенном выше примере графика приведены следующие примеры:

| **Блюпринт**              | **Описание**                                                                                                                      |
| ------------------------- | --------------------------------------------------------------------------------------------------------------------------------- |
| **Персонаж** (1)          | Здесь используется узел **Get Player Character** и мы приводим к блюпринту персонажа с именем **MyCharacter**.                    |
| **Контроллер Игрока** (2) | Здесь используется узел **Get Player Controller** и мы приводим к блюпринту контроллера игрока с именем **MyController**.         |
| **Режим Игры** (3)        | Здесь используется узел **Get Game Mode** и мы приводим к блюпринту режима игры с именем **MyGame**.                              |
| **Пешка** (4)             | Здесь используются узлы **Get Controlled Pawn** и **Get Player Controller** для приведения к блюпринту пешки с именем **MyPawn**. |
| **HUD** (5)               | Здесь используются узлы **Get HUD** и **Get Player Controller** для приведения к блюпринту HUD с именем **MyHUD**.                |

В каждом из приведенных выше примеров перетаскивание узла **As My X** (где X - тип схемы элементов) позволит вам получить доступ к событиям, переменным, функциям и т.д. из соответствующих схем элементов.

Также следует отметить, что значение **Player Index** в узлах **Get Player Character** и **Get Player Controller** может использоваться для указания разных игроков в многопользовательском сценарии. Для одиночного сценария достаточно оставить значение 0.

## Target Blueprint Casting

Существуют также случаи, когда вы можете использовать переменную для **приведения к** определенному типу чертежа, чтобы получить к нему доступ.

![[createcasting.png]]

На рисунке выше для номера 1 создан объект **Save Game Object**, который присваивается переменной **SaveGameObject**. Затем эта переменная используется для **Cast To** Схему сохранения игры, называемую **MySaveGame**, которая может использоваться для передачи или извлечения информации о сохранении игры, такой как высокий балл, лучшее время прохождения круга и т.д.

На изображении выше для номера 2 создается схема элементов **UserWidget**, которая присваивается переменной **UserWidget**. Затем эта переменная используется для преобразования в схему элементов виджета под названием *MyWidgetBlueprint*, которая может использоваться для обновления или извлечения информации из схемы элементов виджета (это может быть HUD или другой элемент пользовательского интерфейса, к которому вы хотите получить доступ).

## Источники
- #### [dev.epicgames](https://dev.epicgames.com/documentation/en-us/unreal-engine/blueprint-communications-in-unreal-engine)
