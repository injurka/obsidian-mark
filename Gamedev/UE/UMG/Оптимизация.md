## Лучшие практики оптимизации UMG в Unreal Engine 5

### Избегайте биндингов
Функции, которые забинжены, будут выполняться каждый тик. Редко бывает, что нужно изменять интерфейс так часто, поэтому лучше использовать события или функции.

### Избегайте альфа-канала для элементов
Полупрозрачные элементы нужно рендерить слоями, что увеличивает нагрузку.

### Процедурная анимация тяжелее покадровой
Процедурная анимация, например, встроенный в UMG Timeline или анимации из программы Spine, может быть в десятки раз тяжелее. В процедурной анимации отрисовка меняется каждый тик, также идет нагрузка на процессор каждый тик из-за математических операций. Timeline также добавляет нагрузку на контейнер на каждый тик.

### Контейнер внутри контейнера
В каждом фрейме движок рекурсивно проходит по C++ функцией `Widget Paint` по вложенным в друг друга элементам виджетов.

### Изменение содержимого в runtime из контейнеров
Добавление и удаление чилдов из контейнеров, таких как Horizontal Box, довольно дорого. Иногда проще установить `Render Offset` для имитации, например, Vertical Box.

### Убирайте кликабельность элементов
По умолчанию всегда стоит `Visible` для `Behaviour Visibility`. Стоит менять его на `Not Hit`, чтобы сэкономить ресурсы.

### Используйте `Collapsed` вместо `Hidden`
Когда нужно спрятать элемент, нужно задавать `Visibility` как `Collapsed`. Данный вариант снимает необходимость рассчитывать геометрию скрытого элемента и его влияния на соседние элементы.

## Вспомогательный функционал

### Используйте Atlas
Лучше использовать большие изображения, которые содержат множество маленьких изображений (спрайтов) в одном файле. Это позволяет оптимизировать загрузку и рендеринг графики.

### Оборачивайте контейнеры в `Retainer Box`
Используйте только в родительском виджете для минимизации возможных проблем. `Retainer Box` должен быть минимально возможным, он не предназначен для больших элементов.

### Кешируйте через `Invalidation Box`
Данный контейнер кеширует результаты своего контента, чтобы не было лишних переотрисовок. Данный функционал стоит использовать для элементов, которые редко меняют содержимое. Не стоит хранить большую вложенность объектов внутри `Invalidation Box`.

Если элемент часто меняется, то стоит ему поставить флаг `Is Volatile`, что позволяет убрать кеширование для данного элемента. Если нужно анимировать `Invalidation Box`, то нужно на этот период включить режим `Force Volatile`.

Порой можно оборачивать `Invalidation Box` в `Retainer Box` для большей оптимизации.

## Дополнительные советы

### Используйте `Slate Brush` для статичных элементов
Если у вас есть статичные элементы интерфейса, которые не меняются, используйте `Slate Brush` вместо текстур. Это может значительно снизить нагрузку на GPU.

### Оптимизируйте количество текстур
Используйте минимальное количество текстур и старайтесь объединять их в атласы. Это уменьшит количество вызовов на GPU и улучшит производительность.

### Используйте `Async Loading` для загрузки ресурсов
Если вам нужно загружать большие ресурсы во время работы приложения, используйте асинхронную загрузку. Это позволит избежать зависаний и подвисаний интерфейса.

### Ограничьте количество обновлений в тик
Если у вас есть элементы, которые обновляются каждый тик, попробуйте ограничить количество обновлений. Например, обновляйте их только каждые несколько тиков или только при изменении определенных условий.

### Используйте `FName` вместо строк
При работе с идентификаторами и именами элементов, используйте `FName` вместо строк. `FName` более оптимизирован и использует меньше памяти.

### Оптимизируйте использование `UMG` в VR
Если вы разрабатываете VR-приложение, помните, что UMG может быть особенно требовательным к ресурсам. Используйте минимальное количество элементов и старайтесь оптимизировать их рендеринг.

Эти советы помогут вам оптимизировать использование UMG в Unreal Engine 5 и улучшить общую производительность вашего проекта.